<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}LinkBay{% endblock %}</title>
    <meta name="description" content="{% block description %}LinkBay CMS - Dashboard{% endblock %}">
    <meta name="author" content="Quagliara Alessio">
    <link rel="shortcut icon" href="/static/images/superadmin/favicon.ico" type="image/x-icon">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- AOS Animation -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <!-- SweetAlert2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <!-- Custom CSS -->
    <style>
      #wrapper {
        display: flex;
        flex-direction: row;
      }

      #sidebar {
        width: 240px;
        min-width: 240px;
        transition: all 0.3s ease;
      }

      #wrapper.toggled #sidebar {
        margin-left: -240px;
      }

      #page-content-wrapper {
        flex-grow: 1;
        padding: 20px;
        transition: all 0.3s ease;
      }

      @media (max-width: 768px) {
        #sidebar {
          position: absolute;
          top: 0;
          bottom: 0;
          left: 0;
          z-index: 1030;
          background-color: #f8f9fa;
          margin-left: -240px;
        }

        #wrapper.toggled #sidebar {
          margin-left: 0;
        }

        #page-content-wrapper {
          width: 100%;
          padding: 20px;
        }
      }

      .nav-link {
        padding: 10px 15px;
        color: #333;
        border-radius: 8px;
        transition: all 0.3s ease;
        font-weight: 500;
      }

      .nav-link:hover,
      .nav-link.active {
        background-color: #ff5757;
        color: #fff !important;
      }

      .brand img {
        max-width: 100%;
      }

      #sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.4);
        z-index: 1020;
        display: none;
      }
      #wrapper.toggled + #sidebar-overlay {
        display: block;
      }
    </style>
    {% block head %}{% endblock %}
</head>
<body>
    <!-- Mobile Toggle Button -->
    <button class="btn btn-outline-secondary d-md-none m-2" id="sidebarToggle">
      <i class="fas fa-bars"></i>
    </button>
    <div class="d-flex" id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar" class="d-flex flex-column flex-shrink-0 p-3 bg-light border-end min-vh-100">
          <div>
            <a href="#" class="brand d-flex align-items-center mb-4">
              <img src="/static/images/superadmin/linkbay_logo.png" alt="LinkBay Logo" width="140">
            </a>
            <nav class="nav flex-column">
              <a href="/dashboard" class="nav-link {% if request.path == '/dashboard' %}active{% endif %}"><i class="fa-solid fa-house me-2"></i> Home</a>
              <a href="/dashboard/stores" class="nav-link {% if '/dashboard/stores' in request.path %}active{% endif %}"><i class="fa-solid fa-store me-2"></i> Negozi</a>
              <a href="/dashboard/sales" class="nav-link {% if '/dashboard/sales' in request.path %}active{% endif %}"><i class="fa-solid fa-chart-line me-2"></i> Vendite</a>
              <a href="/dashboard/apps" class="nav-link {% if '/dashboard/apps' in request.path %}active{% endif %}"><i class="fa-solid fa-cubes me-2"></i> App</a>
              <a href="/dashboard/themes" class="nav-link {% if '/dashboard/themes' in request.path %}active{% endif %}"><i class="fa-solid fa-palette me-2"></i> Temi</a>
              <a href="/dashboard/support" class="nav-link {% if '/dashboard/support' in request.path %}active{% endif %}"><i class="fa-solid fa-headset me-2"></i> Supporto</a>
              <a href="/dashboard/team" class="nav-link {% if '/dashboard/team' in request.path %}active{% endif %}"><i class="fa-solid fa-users me-2"></i> Collabora</a>
              <a href="/dashboard/payouts" class="nav-link {% if '/dashboard/payouts' in request.path %}active{% endif %}"><i class="fa-solid fa-credit-card me-2"></i> Pagamenti</a>
            </nav>
          </div>
          <div>
            <hr>
            <div class="dropdown mt-3">
              <a class="d-flex align-items-center text-decoration-none dropdown-toggle nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <img src="{{ user['profilo_foto'] if user and user['profilo_foto'] else '/static/images/superadmin/user_extend.png' }}"
                     alt="user" width="32" height="32" class="rounded-circle me-2" style="object-fit: cover; border: 2px solid #ff5757;">
                <strong class="text-dark">{{ user['nome'] if user and user['nome'] else 'Utente' }}</strong>
              </a>
              <ul class="dropdown-menu shadow-sm">
                <li><a class="dropdown-item" href="/dashboard/settings"><i class="fas fa-user-cog me-2"></i> Profilo</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-danger" href="/logout"><i class="fas fa-sign-out-alt me-2"></i> Logout</a></li>
              </ul>
            </div>
          </div>
        </div>
        <!-- Page Content -->
        <div id="page-content-wrapper" class="flex-grow-1">
          <div class="container-fluid mt-4">
            {% block content %}{% endblock %}
          </div>
        </div>
      </div>
      
      <div id="sidebar-overlay" class="d-md-none"></div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    AOS.init({ duration: 1000, once: true });

    // Nasconde sidebar all'avvio su mobile
    if (window.innerWidth < 768) {
      $('#wrapper').addClass('toggled');
    }

    $('#sidebarToggle').on('click', function () {
      $('#wrapper').toggleClass('toggled');
    });

    // Chiudi sidebar cliccando sull'overlay
    $('#sidebar-overlay').on('click', function () {
      $('#wrapper').removeClass('toggled');
    });
  </script>
  {% block scripts %}{% endblock %}
</body>
</html>