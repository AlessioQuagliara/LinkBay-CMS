{% extends "landing/admin_base.html" %}

{% block title %}Editor contenuti - {{ content_type }}{% endblock %}

{% block content %}
<div class="container">
  <h2 class="mb-4">Editor {{ content_type|capitalize }}</h2>
  <input type="text" id="filename" class="form-control mb-3" placeholder="Nome del file...">

  <div id="editor" style="height: 300px;"></div>
  <button class="btn btn-primary mt-3" onclick="saveContent()">Salva</button>
</div>
{% endblock %}

{% block extra_scripts %}
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <script>
    const quill = new Quill('#editor', {
      theme: 'snow'
    });

    function saveContent() {
      const delta = quill.getContents();
      const filename = document.getElementById('filename').value || 'default';

      fetch(`/landing/admin/save_content/{{ content_type }}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ filename, delta })
      })
      .then(res => res.json())
      .then(data => alert(data.message));
    }
  </script>
{% endblock %}