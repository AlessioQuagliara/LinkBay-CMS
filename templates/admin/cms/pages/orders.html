{% extends "/admin/cms/interface/render.html" %}

{% block content %}

<div class="container my-4" data-aos="fade-up">
    
    <!-- Inclusione dei file CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin/toolbar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin/orders/orders_table.css') }}">
    
    <!-- Card per le funzioni della tabella -->
    <div class="card shadow-sm mb-4">
        <div class="card-body d-flex justify-content-between align-items-center">
            <div class="d-flex gap-3">
                <a href="/admin/cms/pages/orders" class="btn {% if title == 'Orders' %}btn-dark{% else %}btn-outline-dark{% endif %} btn-sm text-decoration-none">
                    <i class="fa-solid fa-note-sticky"></i> All
                </a>
            </div>
            <div class="custom-toolbar">
                <button class="custom-btn" id="search-toggle-btn" title="Search">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input type="text" id="search-input" class="custom-input d-none" placeholder="Search..." style="max-width: 200px;">
                </button>
                
                <button class="custom-btn" title="Add Order" id="add-order-btn">
                    <i class="fa-solid fa-plus"></i>
                </button>
              
                <button class="custom-btn select-all" title="Select All">
                    <i class="fa-solid fa-check"></i>
                </button>
              
                <button class="custom-btn delete-selected" title="Delete">
                    <i class="fa-solid fa-trash"></i>
                </button>
              
                <button class="custom-btn" title="Export" id="export-order-btn">
                    <i class="fa-solid fa-file-excel"></i>
                </button>
              
                <button class="custom-btn" data-bs-toggle="modal" data-bs-target="#customizationModal" id="customize-columns" title="Customize Columns">
                    <i class="fa-solid fa-cog"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Tabella degli ordini -->
    <div class="table-responsive">
        <table class="table table-hover table-bordered align-middle text-center" style="border-radius: 10px;">
            <thead class="table-dark">
                <tr>
                    <th scope="col"><input type="checkbox" id="select-all-checkbox"></th>
                    <th scope="col" class="id">#</th>
                    <th scope="col" class="order_number">Order Number</th>
                    <th scope="col" class="customer_name">Customer Name</th>
                    <th scope="col" class="customer_email">Customer Email</th>
                    <th scope="col" class="total_items">Total Items</th>
                    <th scope="col" class="total_quantity">Total Quantity</th>
                    <th scope="col" class="total_amount">Total Amount</th>
                    <th scope="col" class="status">Status</th>
                    <th scope="col" class="created_at">Created At</th>
                    <th scope="col" class="updated_at">Updated At</th>
                </tr>
            </thead>
            <tbody>
                {% for order in orders %}
                <tr class="table-row" data-order-id="{{ order.id }}">
                    <td><input type="checkbox" class="row-checkbox"></td>
                    <td class="id">{{ order.id }}</td>
                    <td class="order_number">{{ order.order_number }}</td>
                    <td class="customer_name">{{ order.customer_name or 'N/A' }}</td>
                    <td class="customer_email">{{ order.customer_email or 'N/A' }}</td>
                    <td class="total_items">{{ order.total_items }}</td>
                    <td class="total_quantity">{{ order.total_quantity }}</td>
                    <td class="total_amount">{{ order.total_amount }}</td>
                    <td class="status" 
                        {% if order.status == 'Draft' %} style="font-weight: bold; background-color: #dfe2e6; color: #b0b1b5;"
                        {% elif order.status == 'Pending' %} style="font-weight: bold; background-color: #ffc108; color: #332702;"
                        {% elif order.status == 'Shipped' %} style="font-weight: bold; background-color: #11cbf0; color: #032830;"
                        {% elif order.status == 'Complete' %} style="font-weight: bold; background-color: #1a8754; color: #051c12;"
                        {% elif order.status == 'Abbandoned' %} style="font-weight: bold; background-color: #db3545; color: #2b0b0e;"
                        {% endif %}>
                        {{ order.status }}
                    </td>
                    <td class="created_at">{{ order.created_at }}</td>
                    <td class="updated_at">{{ order.updated_at }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Modal di configurazione -->
<div class="modal fade" id="customizationModal" tabindex="-1" aria-labelledby="customizationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="customizationModalLabel">Customize Table View</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6>Columns to Display</h6>
                <div id="columns-container">
                    <!-- Opzioni delle colonne generate dinamicamente -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Inclusione dei file JavaScript -->
<script src="{{ url_for('static', filename='js/admin/orders/orders.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin/tables/research_method.js') }}"></script>

{% endblock %}