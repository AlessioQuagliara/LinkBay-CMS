{% extends "/admin/cms/interface/render.html" %}

{% block content %}
<!-- CONTENUTO -->

<div class="container my-4" data-aos="fade-up">

    <!-- General Information Section -->
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-dark">
            <h6 class="text-white mb-0">General Information</h6>
        </div>
        <div class="card-body">
            <form id="customer-form">
                <input type="hidden" id="customer-id" name="id" value="{{ customer.id }}">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label for="first_name" class="form-label">First Name</label>
                        <input type="text" class="form-control" id="first_name" name="first_name" value="{{ customer.first_name }}" required>
                    </div>
                    <div class="col-md-6">
                        <label for="last_name" class="form-label">Last Name</label>
                        <input type="text" class="form-control" id="last_name" name="last_name" value="{{ customer.last_name }}" required>
                    </div>
                </div>
                <div class="row g-3 mt-3">
                    <div class="col-md-6">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" name="email" value="{{ customer.email }}" required>
                    </div>
                    <div class="col-md-6">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" name="password" value="{{ customer.password }}">
                    </div>
                </div>
                <div class="row g-3 mt-3">
                    <div class="col-md-6">
                        <label for="phone" class="form-label">Phone</label>
                        <input type="text" class="form-control" id="phone" name="phone" value="{{ customer.phone }}">
                    </div>
                    <div class="col-md-6">
                        <label for="address" class="form-label">Address</label>
                        <input type="text" class="form-control" id="address" name="address" value="{{ customer.address }}">
                    </div>
                </div>
                <div class="row g-3 mt-3">
                    <div class="col-md-6">
                        <label for="city" class="form-label">City</label>
                        <input type="text" class="form-control" id="city" name="city" value="{{ customer.city }}">
                    </div>
                    <div class="col-md-6">
                        <label for="state" class="form-label">State</label>
                        <input type="text" class="form-control" id="state" name="state" value="{{ customer.state }}">
                    </div>
                </div>
                <div class="row g-3 mt-3">
                    <div class="col-md-6">
                        <label for="postal_code" class="form-label">Postal Code</label>
                        <input type="text" class="form-control" id="postal_code" name="postal_code" value="{{ customer.postal_code }}">
                    </div>
                    <div class="col-md-6">
                        <label for="country" class="form-label">Country</label>
                        <input type="text" class="form-control" id="country" name="country" value="{{ customer.country }}">
                    </div>
                </div>
            </form>
        </div>
    </div>

</div>

<!-- Script -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Pulsante di salvataggio
    const saveButton = document.getElementById('save-content');
    saveButton.addEventListener('click', () => {
        console.log("Save button clicked");

        const customerForm = document.getElementById('customer-form');
        const formData = new FormData(customerForm);

        Swal.fire({
            title: 'Saving...',
            text: 'Please wait while your changes are being saved.',
            icon: 'info',
            allowOutsideClick: false,
            showConfirmButton: false,
            didOpen: () => Swal.showLoading()
        });

        fetch('/api/update_customer', {
            method: 'POST',
            body: formData,
        })
            .then(response => response.json())
            .then(data => {
                console.log("Response:", data);
                if (data.success) {
                    Swal.fire('Success', data.message, 'success');
                } else {
                    Swal.fire('Error', data.message || 'Failed to update the customer.', 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                Swal.fire('Error', 'A network or server error occurred.', 'error');
            });
    });
});
</script>
{% endblock %}