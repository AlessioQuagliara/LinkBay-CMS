<script>
document.addEventListener('DOMContentLoaded', function() {
    var editor = grapesjs.init({
        container: '#editor',
        fromElement: true,
        height: '100vh',
        width: 'auto',
        storageManager: false,
        plugins: [
            'gjs-preset-webpage'
        ],
        blockManager: {
            openCategories: false
        },
        pluginsOpts: {
            'gjs-preset-webpage': {
                showStylesOnChange: false // disable the preset behavior that always opens the styles panel whenever a component is selected
            }
        },
        canvas: {
            styles: [
                'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css',
                'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css'
            ],
            scripts: [
                'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js'
            ]
        }
    });


// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI PER LAYOUT DI BASE -------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 
        editor.BlockManager.add('section', {
            label: '<i class="fa-solid fa-border-top fa-4x"></i> Section',
            content: '<section class="py-5 d-flex align-items-center justify-content-center bg-light">\n <div class="container">\n <h2 class="fw-bold text-dark text-center">Section Title</h2>\n <p class="text-center text-muted">\n Add your content here...</p>\n </div>\n </section>',
            category: 'Layout',
        });

        editor.BlockManager.add('full-section', {
            label: '<i class="fa-solid fa-expand fa-4x"></i> Full Section',
            content: '<section class="vh-100 d-flex align-items-center justify-content-center bg-dark text-white"><div class="container text-center"><h2 class="fw-bold">Full Width Section</h2><p>This section takes the full viewport height.</p></div></section>',
            category: 'Layout',
        });

        editor.BlockManager.add('container-layout', {
            label: '<i class="fa-solid fa-box fa-4x"></i> Container',
            content: '<section class="container d-flex align-items-center justify-content-center py-5 bg-light"></section>',
            category: 'Layout',
        });

        editor.BlockManager.add('grid', {
            label: '<i class="fa-solid fa-th-large fa-4x"></i> Grid',
            content: '<div class="row"><div class="col-md-6 bg-light p-3">Column 1</div><div class="col-md-6 bg-dark text-white p-3">Column 2</div></div>',
            category: 'Layout',
        });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI BASE: Testo, immagini, ecc.. ---------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('heading', {
            label: '<i class="fa-solid fa-heading fa-4x"></i> Heading',
            content: '<h2 class="fw-bold text-dark">Heading</h2>',
            category: 'Basic',
        });

        editor.BlockManager.add('image', {
            label: '<i class="fa-solid fa-image fa-4x"></i> Image',
            content: '<img src="https://via.placeholder.com/350x250" class="img-fluid"/>',
            category: 'Basic',
        });

        editor.BlockManager.add('text-editor', {
            label: '<i class="fa-solid fa-file-alt fa-4x"></i> Text Editor',
            content: '<div class="p-3">Write your text here...</div>',
            category: 'Basic',
        });

        editor.BlockManager.add('video', {
            label: '<i class="fa-solid fa-video fa-4x"></i> Video',
            content: '<video controls><source src="movie.mp4" type="video/mp4">Your browser does not support the video tag.</video>',
            category: 'Basic',
        });

        editor.BlockManager.add('button', {
            label: '<i class="fa-solid fa-hand-pointer fa-4x"></i> Button',
            content: '<button class="btn btn-primary">Click Me</button>',
            category: 'Basic',
        });

        editor.BlockManager.add('divider', {
            label: '<i class="fa-solid fa-grip-lines fa-4x"></i> Divider',
            content: '<hr class="my-4"/>',
            category: 'Basic',
        });

        editor.BlockManager.add('spacer', {
            label: '<i class="fa-solid fa-arrows-alt-v fa-4x"></i> Spacer',
            content: '<div style="height: 50px;"></div>',
            category: 'Basic',
        });

        editor.BlockManager.add('icon', {
            label: '<i class="fa-solid fa-icons fa-4x"></i> Icon',
            content: '<i class="fa-solid fa-star"></i>',
            category: 'Basic',
        });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI SEMPLICI -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('simple-header', {
            label: '<i class="fa-solid fa-header fa-4x"></i> Simple Header',
            content: `
                <header class="py-3 bg-light">
                <div class="container text-center">
                    <img src="https://via.placeholder.com/150x50" alt="Logo" class="img-fluid mb-2">
                    <h1 class="h3">Welcome to Our Store</h1>
                </div>
                </header>
            `,
            category: 'Simple'
            });

        editor.BlockManager.add('simple-text', {
            label: '<i class="fa-solid fa-file-alt fa-4x"></i> Simple Text',
            content: `
                <div class="container py-4">
                <p class="lead">This is a simple text block. Edit this text to share your message with your customers.</p>
                </div>
            `,
            category: 'Simple'
            });

        editor.BlockManager.add('simple-contact-form', {
            label: '<i class="fa-solid fa-envelope fa-4x"></i> Simple Contact Form',
            content: `
            <section class="py-5">
                <div class="container">
                    <h2 class="mb-4">Contact Us</h2>
                    <form>
                    <div class="mb-3">
                        <input type="text" class="form-control" placeholder="Your Name">
                    </div>
                    <div class="mb-3">
                        <input type="email" class="form-control" placeholder="Your Email">
                    </div>
                    <div class="mb-3">
                        <textarea class="form-control" rows="3" placeholder="Your Message"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Send Message</button>
                    </form>
                </div>
                </section>
            `,
            category: 'Simple'
            });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI FONDAMENTALI  ------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        // Blocco Advanced Container: un contenitore flessibile che funge da base per altri elementi
            editor.BlockManager.add('advanced-container', {
            label: '<i class="fa-solid fa-border-all fa-4x"></i> Advanced Container',
            content: `
                <div class="container my-5">
                <div class="row">
                    <div class="col">
                    <!-- Inserisci qui il tuo contenuto -->
                    <p>Container content here...</p>
                    </div>
                </div>
                </div>
            `,
            category: 'Fundamental',
            });

            // Blocco Responsive Grid Layout: una griglia con colonne flessibili per creare layout complessi
            editor.BlockManager.add('responsive-grid', {
            label: '<i class="fa-solid fa-th-large fa-4x"></i> Responsive Grid',
            content: `
                <div class="container my-5">
                <div class="row">
                    <div class="col-md-4 mb-3">
                    <div class="p-3 bg-light text-center">Column 1</div>
                    </div>
                    <div class="col-md-4 mb-3">
                    <div class="p-3 bg-light text-center">Column 2</div>
                    </div>
                    <div class="col-md-4 mb-3">
                    <div class="p-3 bg-light text-center">Column 3</div>
                    </div>
                </div>
                </div>
            `,
            category: 'Fundamental',
            });

            // Blocco Parallax Section: una sezione con effetto parallax per sfondi dinamici
            editor.BlockManager.add('parallax-section', {
            label: '<i class="fa-solid fa-layer-group fa-4x"></i> Parallax Section',
            content: `
                <section class="parallax-section" style="position: relative; height: 400px; overflow: hidden;">
                <div class="parallax-bg" style="background-image: url('https://via.placeholder.com/1920x1080'); background-attachment: fixed; background-size: cover; background-position: center; position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div>
                <div class="container h-100 d-flex align-items-center justify-content-center">
                    <h2 class="text-white">Parallax Section</h2>
                </div>
                </section>
            `,
            category: 'Fundamental',
            });

            // Blocco Advanced Navigation Menu: un menu di navigazione personalizzabile per header o sidebar
            editor.BlockManager.add('advanced-nav-menu', {
            label: '<i class="fa-solid fa-bars fa-4x"></i> Advanced Navigation',
            content: `
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">Brand</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#advancedNav" aria-controls="advancedNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="advancedNav">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
                        <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="advancedDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Services
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="advancedDropdown">
                            <li><a class="dropdown-item" href="#">Service 1</a></li>
                            <li><a class="dropdown-item" href="#">Service 2</a></li>
                            <li><a class="dropdown-item" href="#">Service 3</a></li>
                        </ul>
                        </li>
                        <li class="nav-item"><a class="nav-link" href="#">Contact</a></li>
                    </ul>
                    </div>
                </div>
                </nav>
            `,
            category: 'Fundamental',
            });

            // Blocco Customizable CTA: un call-to-action avanzato con opzioni modificabili
            editor.BlockManager.add('custom-cta', {
            label: '<i class="fa-solid fa-bullhorn fa-4x"></i> Custom CTA',
            content: `
                <section class="cta-section text-center py-5" style="background-color: #007bff; color: #fff;">
                <div class="container">
                    <h2>Take Action Now!</h2>
                    <p class="lead">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                    <a href="#" class="btn btn-light btn-lg">Get Started</a>
                </div>
                </section>
            `,
            category: 'Fundamental',
            });

            // Blocco Animated Button: un pulsante animato per attirare l'attenzione
            editor.BlockManager.add('animated-button', {
            label: '<i class="fa-solid fa-hand-pointer fa-4x"></i> Animated Button',
            content: `
                <style>
                .animated-btn {
                    position: relative;
                    display: inline-block;
                    padding: 12px 24px;
                    font-size: 16px;
                    color: #fff;
                    background-color: #28a745;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    overflow: hidden;
                }
                .animated-btn::after {
                    content: "";
                    position: absolute;
                    top: 0;
                    left: -100%;
                    width: 100%;
                    height: 100%;
                    background: rgba(255,255,255,0.3);
                    transition: left 0.5s;
                }
                .animated-btn:hover::after {
                    left: 100%;
                }
                </style>
                <button class="animated-btn">Click Me!</button>
            `,
            category: 'Fundamental',
            });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI AVANZATI -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('google-maps', {
            label: '<i class="fa-solid fa-map-marker-alt fa-4x"></i> Google Maps',
            content: '<iframe width="100%" height="300" frameborder="0" style="border:0" src="https://www.google.com/maps/embed" allowfullscreen></iframe>',
            category: 'Advanced',
        });

        editor.BlockManager.add('timeline', {
            label: '<i class="fa-solid fa-stream fa-4x"></i> Timeline',
            content: '<ul class="timeline"><li><div class="timeline-badge"><i class="fa-solid fa-check"></i></div><div class="timeline-panel"><h4>Event Title</h4><p>Description of the event.</p></div></li><li><div class="timeline-badge"><i class="fa-solid fa-check"></i></div><div class="timeline-panel"><h4>Event Title</h4><p>Description of the event.</p></div></li></ul>',
            category: 'Advanced',
        });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI FORM ---------------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('form', {
            label: '<i class="fa-solid fa-envelope fa-4x"></i> Form',
            content: '<form><input type="text" placeholder="Your Name" class="form-control mb-2"/><input type="email" placeholder="Your Email" class="form-control mb-2"/><textarea placeholder="Your Message" class="form-control mb-2"></textarea><button class="btn btn-primary">Submit</button></form>',
            category: 'Forms',
        });

        editor.BlockManager.add('contact-form', {
            label: '<i class="fa-solid fa-envelope fa-4x"></i> Contact Form',
            content: `
                <form>
                <div class="mb-3">
                    <label for="contact-name" class="form-label">Name</label>
                    <input type="text" class="form-control" id="contact-name" placeholder="Your Name">
                </div>
                <div class="mb-3">
                    <label for="contact-email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="contact-email" placeholder="name@example.com">
                </div>
                <div class="mb-3">
                    <label for="contact-message" class="form-label">Message</label>
                    <textarea class="form-control" id="contact-message" rows="3" placeholder="Your Message"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Send Message</button>
                </form>
            `,
            category: 'Forms'
            });

            editor.BlockManager.add('registration-form', {
                label: '<i class="fa-solid fa-user-plus fa-4x"></i> Registration Form',
                content: `
                <section class="registration-form py-5">
                <div class="container">
                    <h2 class="mb-4 text-center">Register</h2>
                    <form>
                    <div class="mb-3">
                        <input type="text" class="form-control" placeholder="Full Name" required>
                    </div>
                    <div class="mb-3">
                        <input type="email" class="form-control" placeholder="Email Address" required>
                    </div>
                    <div class="mb-3">
                        <input type="password" class="form-control" placeholder="Password" required>
                    </div>
                    <div class="mb-3">
                        <input type="password" class="form-control" placeholder="Confirm Password" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Register</button>
                    </form>
                </div>
                </section>
                `,
                category: 'Forms'
            });

            editor.BlockManager.add('login-form', {
                label: '<i class="fa-solid fa-sign-in-alt fa-4x"></i> Login Form',
                content: `
                <section class="login-form py-5">
                <div class="container">
                    <h2 class="mb-4 text-center">Login</h2>
                    <form>
                    <div class="mb-3">
                        <input type="email" class="form-control" placeholder="Email Address" required>
                    </div>
                    <div class="mb-3">
                        <input type="password" class="form-control" placeholder="Password" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Login</button>
                    </form>
                </div>
                </section>
                `,
                category: 'Forms'
            });

            editor.BlockManager.add('feedback-form', {
                label: '<i class="fa-solid fa-comment-dots fa-4x"></i> Feedback Form',
                content: `
                <section class="feedback-form py-5">
                <div class="container">
                    <h2 class="mb-4 text-center">Feedback</h2>
                    <form>
                    <div class="mb-3">
                        <input type="text" class="form-control" placeholder="Your Name">
                    </div>
                    <div class="mb-3">
                        <input type="email" class="form-control" placeholder="Your Email">
                    </div>
                    <div class="mb-3">
                        <textarea class="form-control" rows="4" placeholder="Your Feedback"></textarea>
                    </div>
                    <button type="submit" class="btn btn-success w-100">Submit Feedback</button>
                    </form>
                </div>
                </section>
                `,
                category: 'Forms'
            });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI ELEMENTS -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('image-box', {
            label: '<i class="fa-solid fa-image fa-4x"></i> Image Box',
            content: '<div class="text-center"><img src="https://via.placeholder.com/150" class="img-fluid mb-2"/><h4>Title</h4><p>Description</p></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('icon-box', {
            label: '<i class="fa-solid fa-icons fa-4x"></i> Icon Box',
            content: '<div class="text-center"><i class="fa-solid fa-star fa-3x mb-2"></i><h4>Title</h4><p>Description</p></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('image-carousel', {
            label: '<i class="fa-solid fa-images fa-4x"></i> Image Carousel',
            content: '<div id="carouselExample" class="carousel slide" data-bs-ride="carousel"><div class="carousel-inner"><div class="carousel-item active"><img src="https://via.placeholder.com/800x400" class="d-block w-100"></div><div class="carousel-item"><img src="https://via.placeholder.com/800x400" class="d-block w-100"></div></div><button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span></button></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('basic-gallery', {
            label: '<i class="fa-solid fa-th fa-4x"></i> Basic Gallery',
            content: '<div class="row"><div class="col-4"><img src="https://via.placeholder.com/150" class="img-fluid"></div><div class="col-4"><img src="https://via.placeholder.com/150" class="img-fluid"></div><div class="col-4"><img src="https://via.placeholder.com/150" class="img-fluid"></div></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('icon-list', {
            label: '<i class="fa-solid fa-list fa-4x"></i> Icon List',
            content: '<ul class="list-unstyled"><li><i class="fa-solid fa-check"></i> Item 1</li><li><i class="fa-solid fa-check"></i> Item 2</li><li><i class="fa-solid fa-check"></i> Item 3</li></ul>',
            category: 'Elements',
        });

        editor.BlockManager.add('counter', {
            label: '<i class="fa-solid fa-sort-numeric-up fa-4x"></i> Counter',
            content: '<div class="text-center"><h2 class="fw-bold">100</h2><p>Completed Projects</p></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('progress-bar', {
            label: '<i class="fa-solid fa-chart-line fa-4x"></i> Progress Bar',
            content: '<div class="progress"><div class="progress-bar" role="progressbar" style="width: 75%;">75%</div></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('testimonial', {
            label: '<i class="fa-solid fa-comment fa-4x"></i> Testimonial',
            content: '<blockquote class="blockquote"><p>"This is the best service I have ever used!"</p><footer class="blockquote-footer">John Doe</footer></blockquote>',
            category: 'Elements',
        });

        editor.BlockManager.add('tabs', {
            label: '<i class="fa-solid fa-folder fa-4x"></i> Tabs',
            content: '<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab1">Tab 1</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab2">Tab 2</a></li></ul><div class="tab-content"><div id="tab1" class="tab-pane fade show active p-3">Content 1</div><div id="tab2" class="tab-pane fade p-3">Content 2</div></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('accordion', {
            label: '<i class="fa-solid fa-bars fa-4x"></i> Accordion',
            content: '<div class="accordion" id="accordionExample"><div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">Accordion Item #1</button></h2><div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body">Content</div></div></div></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('toggle', {
            label: '<i class="fa-solid fa-toggle-on fa-4x"></i> Toggle',
            content: '<label class="switch"><input type="checkbox"><span class="slider round"></span></label>',
            category: 'Elements',
        });

        editor.BlockManager.add('rating', {
            label: '<i class="fa-solid fa-star-half-alt fa-4x"></i> Rating',
            content: '<div class="rating"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star-half-alt"></i></div>',
            category: 'Elements',
        });

        editor.BlockManager.add('social-media', {
            label: '<i class="fa-solid fa-share-alt fa-4x"></i> Social Media',
            content: `
                <div class="d-flex justify-content-center">
                <a href="#" class="mx-2"><i class="fab fa-facebook fa-2x"></i></a>
                <a href="#" class="mx-2"><i class="fab fa-twitter fa-2x"></i></a>
                <a href="#" class="mx-2"><i class="fab fa-instagram fa-2x"></i></a>
                <a href="#" class="mx-2"><i class="fab fa-linkedin fa-2x"></i></a>
                </div>
            `,
            category: 'Elements'
            });
        
            editor.BlockManager.add('faq-accordion', {
            label: '<i class="fa-solid fa-question-circle fa-4x"></i> FAQ Accordion',
            content: `
                <div class="accordion" id="faqAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
                        FAQ 1: Question?
                    </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Answer to FAQ 1.
                    </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo">
                        FAQ 2: Another Question?
                    </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Answer to FAQ 2.
                    </div>
                    </div>
                </div>
                </div>
            `,
            category: 'Elements',
            });

            editor.BlockManager.add('portfolio-gallery', {
            label: '<i class="fa-solid fa-images fa-4x"></i> Portfolio Gallery',
            content: `
                <section class="portfolio-gallery py-5">
                <div class="container">
                    <div class="row g-3">
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/350x250" class="img-fluid" alt="Portfolio 1">
                    </div>
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/350x250" class="img-fluid" alt="Portfolio 2">
                    </div>
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/350x250" class="img-fluid" alt="Portfolio 3">
                    </div>
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/350x250" class="img-fluid" alt="Portfolio 4">
                    </div>
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/350x250" class="img-fluid" alt="Portfolio 5">
                    </div>
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/350x250" class="img-fluid" alt="Portfolio 6">
                    </div>
                    </div>
                </div>
                </section>
            `,
            category: 'Elements',
            });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI MARKETING -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('call-to-action', {
            label: '<i class="fa-solid fa-bullhorn fa-4x"></i> Call to Action',
            content: '<div class="text-center p-5 bg-primary text-white"><h2>Join Us Today!</h2><p>Sign up now and enjoy exclusive benefits.</p><button class="btn btn-light">Get Started</button></div>',
            category: 'Marketing',
        });

        editor.BlockManager.add('newsletter-signup', {
            label: '<i class="fa-solid fa-envelope-open-text fa-4x"></i> Newsletter Signup',
            content: '<div class="text-center p-4 bg-light"><h3>Subscribe to our Newsletter</h3><p>Stay updated with our latest news and offers.</p><input type="email" placeholder="Enter your email" class="form-control mb-2"><button class="btn btn-primary">Subscribe</button></div>',
            category: 'Marketing',
        });

        editor.BlockManager.add('testimonial-slider', {
        label: '<i class="fa-solid fa-comments fa-4x"></i> Testimonial Slider',
        content: `
            <div id="testimonialCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                <blockquote class="blockquote text-center">
                    <p>"This product is amazing!"</p>
                    <footer class="blockquote-footer">Customer 1</footer>
                </blockquote>
                </div>
                <div class="carousel-item">
                <blockquote class="blockquote text-center">
                    <p>"Excellent customer service."</p>
                    <footer class="blockquote-footer">Customer 2</footer>
                </blockquote>
                </div>
                <div class="carousel-item">
                <blockquote class="blockquote text-center">
                    <p>"I highly recommend this shop."</p>
                    <footer class="blockquote-footer">Customer 3</footer>
                </blockquote>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#testimonialCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#testimonialCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
            </button>
            </div>
        `,
        category: 'Marketing',
        });

        editor.BlockManager.add('banner-cta', {
        label: '<i class="fa-solid fa-bullhorn fa-4x"></i> Banner CTA',
        content: `
            <div class="jumbotron text-center p-5 bg-primary text-white">
            <h1 class="display-4">Big Sale!</h1>
            <p class="lead">Up to 50% off on selected products.</p>
            <hr class="my-4">
            <p>Don't miss out, shop now!</p>
            <a class="btn btn-light btn-lg" href="#" role="button">Shop Now</a>
            </div>
        `,
        category: 'Marketing',
        });

        editor.BlockManager.add('cta-button-group', {
            label: '<i class="fa-solid fa-hand-pointer fa-4x"></i> CTA Group',
            content: `
                <section class="cta-group text-center py-5">
                <div class="container">
                    <h2 class="mb-4">Ready to take action?</h2>
                    <div class="d-flex justify-content-center gap-3">
                    <a href="#" class="btn btn-primary">Learn More</a>
                    <a href="#" class="btn btn-secondary">Get Started</a>
                    </div>
                </div>
                </section>
            `,
            category: 'Marketing',
            });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI SECTIONS -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('team-section', {
            label: '<i class="fa-solid fa-users fa-4x"></i> Team Section',
            content: '<div class="row text-center"><div class="col-md-4"><img src="https://via.placeholder.com/150" class="rounded-circle mb-2"><h4>Member Name</h4><p>Role</p></div><div class="col-md-4"><img src="https://via.placeholder.com/150" class="rounded-circle mb-2"><h4>Member Name</h4><p>Role</p></div><div class="col-md-4"><img src="https://via.placeholder.com/150" class="rounded-circle mb-2"><h4>Member Name</h4><p>Role</p></div></div>',
            category: 'Sections',
        });

        editor.BlockManager.add('hero-section', {
            label: '<i class="fa-solid fa-star fa-4x"></i> Hero Section',
            content: `
                <section class="hero-section" style="background-image: url('https://via.placeholder.com/1920x600'); background-size: cover; background-position: center; padding: 100px 0; text-align: center; color: #fff;">
                <div class="container">
                    <h1 class="display-4">Welcome to Our Store</h1>
                    <p class="lead">Discover the best products here.</p>
                    <a href="#" class="btn btn-primary btn-lg">Shop Now</a>
                </div>
                </section>
            `,
            category: 'Sections'
            });

            editor.BlockManager.add('team-section', {
            label: '<i class="fa-solid fa-users fa-4x"></i> Team Section',
            content: `
                <section class="team-section py-5">
                <div class="container">
                    <div class="row text-center">
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/150" class="rounded-circle mb-2" alt="Team Member">
                        <h4>Member Name</h4>
                        <p>Role</p>
                        <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/150" class="rounded-circle mb-2" alt="Team Member">
                        <h4>Member Name</h4>
                        <p>Role</p>
                        <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <img src="https://via.placeholder.com/150" class="rounded-circle mb-2" alt="Team Member">
                        <h4>Member Name</h4>
                        <p>Role</p>
                        <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </div>
                    </div>
                </div>
                </section>
            `,
            category: 'Sections',
            });

            editor.BlockManager.add('video-banner', {
            label: '<i class="fa-solid fa-video fa-4x"></i> Video Banner',
            content: `
                <section class="video-banner position-relative" style="height: 100vh; overflow: hidden;">
                <video autoplay muted loop style="width: 100%; height: 100%; object-fit: cover;">
                    <source src="https://via.placeholder.com/1920x1080.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                <div class="overlay position-absolute top-50 start-50 translate-middle text-center text-white">
                    <h1 class="display-3">Welcome to Our Store</h1>
                    <p class="lead">Experience the best shopping journey.</p>
                    <a href="#" class="btn btn-primary">Shop Now</a>
                </div>
                </section>
            `,
            category: 'Sections',
            });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI BUSINESS -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('pricing-table', {
            label: '<i class="fa-solid fa-table fa-4x"></i> Pricing Table',
            content: '<div class="row text-center"><div class="col-md-4"><div class="card"><div class="card-header">Basic</div><div class="card-body"><h4>$9.99/month</h4><p>Basic Features</p><button class="btn btn-primary">Choose Plan</button></div></div></div><div class="col-md-4"><div class="card"><div class="card-header">Standard</div><div class="card-body"><h4>$19.99/month</h4><p>Standard Features</p><button class="btn btn-primary">Choose Plan</button></div></div></div><div class="col-md-4"><div class="card"><div class="card-header">Premium</div><div class="card-body"><h4>$29.99/month</h4><p>Premium Features</p><button class="btn btn-primary">Choose Plan</button></div></div></div></div>',
            category: 'Business',
        });

        editor.BlockManager.add('pricing-card', {
            label: '<i class="fa-solid fa-money-bill fa-4x"></i> Pricing Card',
            content: `
                <div class="card text-center">
                <div class="card-header">
                    Basic Plan
                </div>
                <div class="card-body">
                    <h5 class="card-title">$19.99/month</h5>
                    <p class="card-text">Access to all basic features.</p>
                    <a href="#" class="btn btn-success">Choose Plan</a>
                </div>
                <div class="card-footer text-muted">
                    30-day trial available
                </div>
                </div>
            `,
            category: 'Business'
            });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI SUPPORT -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('faq-section', {
            label: '<i class="fa-solid fa-question-circle fa-4x"></i> FAQ Section',
            content: '<div class="accordion" id="faqAccordion"><div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">What is your return policy?</button></h2><div id="faq1" class="accordion-collapse collapse show"><div class="accordion-body">We accept returns within 30 days.</div></div></div><div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">How do I track my order?</button></h2><div id="faq2" class="accordion-collapse collapse"><div class="accordion-body">Track your order through our website.</div></div></div></div>',
            category: 'Support',
        });

        editor.BlockManager.add('support-contact-info', {
          label: '<i class="fa-solid fa-phone fa-4x"></i> Support Contact',
          content: `
            <section class="support-contact-info py-4 bg-light">
              <div class="container text-center">
                <h2>Need Help?</h2>
                <p>Call us: <strong>1-800-123-4567</strong></p>
                <p>Email: <a href="mailto:support@example.com">support@example.com</a></p>
                <p>Hours: Mon-Fri, 9am-6pm</p>
              </div>
            </section>
          `,
          category: 'Support',
        });
        
        editor.BlockManager.add('live-chat-widget', {
          label: '<i class="fa-solid fa-comments fa-4x"></i> Live Chat Widget',
          content: `
            <div class="live-chat-widget" style="position: fixed; bottom: 20px; right: 20px; width: 300px; height: 400px; border: 1px solid #ccc; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
              <div style="background: #007bff; color: #fff; padding: 10px; font-weight: bold;">Live Support</div>
              <div style="padding: 10px; height: calc(100% - 40px); overflow-y: auto;">
                <p>Welcome! How can we help you?</p>
              </div>
            </div>
          `,
          category: 'Support',
        });
        
        editor.BlockManager.add('support-ticket-form', {
          label: '<i class="fa-solid fa-ticket-alt fa-4x"></i> Ticket Form',
          content: `
            <section class="support-ticket-form py-4">
              <div class="container">
                <h2 class="mb-4 text-center">Submit a Support Ticket</h2>
                <form>
                  <div class="mb-3">
                    <input type="text" class="form-control" placeholder="Your Name" required>
                  </div>
                  <div class="mb-3">
                    <input type="email" class="form-control" placeholder="Your Email" required>
                  </div>
                  <div class="mb-3">
                    <textarea class="form-control" rows="4" placeholder="Describe your issue" required></textarea>
                  </div>
                  <button type="submit" class="btn btn-primary w-100">Submit Ticket</button>
                </form>
              </div>
            </section>
          `,
          category: 'Support',
        });
        
        editor.BlockManager.add('knowledge-base', {
          label: '<i class="fa-solid fa-book fa-4x"></i> Knowledge Base',
          content: `
            <section class="knowledge-base py-4 bg-light">
              <div class="container">
                <h2 class="mb-4 text-center">Popular Support Articles</h2>
                <ul class="list-group">
                  <li class="list-group-item"><a href="#">How to Reset Your Password</a></li>
                  <li class="list-group-item"><a href="#">Troubleshooting Common Issues</a></li>
                  <li class="list-group-item"><a href="#">Managing Your Account Settings</a></li>
                </ul>
              </div>
            </section>
          `,
          category: 'Support',
        });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI ECOMMERCE -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('product-card', {
        label: '<i class="fa-solid fa-box-open fa-4x"></i> Product Card',
        content: `
            <div class="card">
            <img src="https://via.placeholder.com/350x250" class="card-img-top" alt="Product">
            <div class="card-body">
                <h5 class="card-title">Product Name</h5>
                <p class="card-text">$99.99</p>
                <a href="#" class="btn btn-primary">Buy Now</a>
            </div>
            </div>
        `,
        category: 'Ecommerce',
        });

        editor.BlockManager.add('product-grid', {
        label: '<i class="fa-solid fa-th-large fa-4x"></i> Product Grid',
        content: `
            <div class="row">
            <div class="col-md-4">
                <div class="card">
                <img src="https://via.placeholder.com/350x250" class="card-img-top" alt="Product 1">
                <div class="card-body">
                    <h5 class="card-title">Product 1</h5>
                    <p class="card-text">$49.99</p>
                    <a href="#" class="btn btn-primary">View Product</a>
                </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                <img src="https://via.placeholder.com/350x250" class="card-img-top" alt="Product 2">
                <div class="card-body">
                    <h5 class="card-title">Product 2</h5>
                    <p class="card-text">$59.99</p>
                    <a href="#" class="btn btn-primary">View Product</a>
                </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                <img src="https://via.placeholder.com/350x250" class="card-img-top" alt="Product 3">
                <div class="card-body">
                    <h5 class="card-title">Product 3</h5>
                    <p class="card-text">$69.99</p>
                    <a href="#" class="btn btn-primary">View Product</a>
                </div>
                </div>
            </div>
            </div>
        `,
        category: 'Ecommerce',
        });

        editor.BlockManager.add('product-comparison', {
        label: '<i class="fa-solid fa-table fa-4x"></i> Product Comparison',
        content: `
            <section class="product-comparison my-5">
            <div class="container">
                <h2 class="text-center mb-4">Product Comparison</h2>
                <table class="table table-bordered">
                <thead>
                    <tr>
                    <th>Feature</th>
                    <th>Product 1</th>
                    <th>Product 2</th>
                    <th>Product 3</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                    <td>Price</td>
                    <td>$49.99</td>
                    <td>$59.99</td>
                    <td>$69.99</td>
                    </tr>
                    <tr>
                    <td>Rating</td>
                    <td>â˜…â˜…â˜…â˜…â˜†</td>
                    <td>â˜…â˜…â˜…â˜†â˜†</td>
                    <td>â˜…â˜…â˜…â˜…â˜…</td>
                    </tr>
                    <tr>
                    <td>Availability</td>
                    <td>In Stock</td>
                    <td>Out of Stock</td>
                    <td>In Stock</td>
                    </tr>
                </tbody>
                </table>
            </div>
            </section>
        `,
        category: 'Ecommerce'
        });

        editor.BlockManager.add('product-review', {
        label: '<i class="fa-solid fa-star fa-4x"></i> Product Review',
        content: `
            <section class="product-review my-5">
            <div class="container">
                <h2 class="text-center mb-4">Customer Reviews</h2>
                <div class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title">Excellent Product!</h5>
                    <p class="card-text">I really enjoyed using this product. Highly recommended!</p>
                    <p class="card-text"><small class="text-muted">- John Doe</small></p>
                </div>
                </div>
                <div class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title">Good value for money</h5>
                    <p class="card-text">Solid performance and affordable price.</p>
                    <p class="card-text"><small class="text-muted">- Jane Smith</small></p>
                </div>
                </div>
            </div>
            </section>
        `,
        category: 'Ecommerce'
        });

        editor.BlockManager.add('shopping-cart-summary', {
        label: '<i class="fa-solid fa-shopping-cart fa-4x"></i> Cart Summary',
        content: `
            <section class="cart-summary my-5">
            <div class="container">
                <h2 class="text-center mb-4">Your Cart</h2>
                <table class="table">
                <thead>
                    <tr>
                    <th>Product</th>
                    <th>Qty</th>
                    <th>Price</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                    <td>Product 1</td>
                    <td>1</td>
                    <td>$49.99</td>
                    </tr>
                    <tr>
                    <td>Product 2</td>
                    <td>2</td>
                    <td>$59.99</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                    <th colspan="2" class="text-end">Total:</th>
                    <th>$169.97</th>
                    </tr>
                </tfoot>
                </table>
                <div class="text-center">
                <a href="#" class="btn btn-primary">Proceed to Checkout</a>
                </div>
            </div>
            </section>
        `,
        category: 'Ecommerce'
        });

        editor.BlockManager.add('featured-products-slider', {
        label: '<i class="fa-solid fa-sliders-h fa-4x"></i> Featured Slider',
        content: `
            <section class="featured-products my-5">
            <div id="featuredCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="https://via.placeholder.com/800x400" class="d-block w-100" alt="Featured 1">
                    <div class="carousel-caption d-none d-md-block">
                    <h5>Featured Product 1</h5>
                    <p>$49.99</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://via.placeholder.com/800x400" class="d-block w-100" alt="Featured 2">
                    <div class="carousel-caption d-none d-md-block">
                    <h5>Featured Product 2</h5>
                    <p>$59.99</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://via.placeholder.com/800x400" class="d-block w-100" alt="Featured 3">
                    <div class="carousel-caption d-none d-md-block">
                    <h5>Featured Product 3</h5>
                    <p>$69.99</p>
                    </div>
                </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#featuredCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#featuredCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                </button>
            </div>
            </section>
        `,
        category: 'Ecommerce'
        });

        editor.BlockManager.add('discount-banner', {
        label: '<i class="fa-solid fa-tags fa-4x"></i> Discount Banner',
        content: `
            <section class="discount-banner text-center py-5" style="background-color: #ff5757; color: #fff;">
            <div class="container">
                <h2>Limited Time Offer!</h2>
                <p>Get up to 30% off on selected items.</p>
                <a href="#" class="btn btn-light btn-lg">Shop Now</a>
            </div>
            </section>
        `,
        category: 'Ecommerce'
        });

// --------------------------------------------------------------------------------------------------------------------
// ---- ðŸ“Œ   BLOCCHI BLOG -----------------------------------------------------------------------------------------
// -------------------------------------------------------------------------------------------------------------------- 

        editor.BlockManager.add('blog-preview', {
        label: '<i class="fa-solid fa-blog fa-4x"></i> Blog Preview',
        content: `
            <div class="card">
            <img src="https://via.placeholder.com/350x200" class="card-img-top" alt="Blog Post">
            <div class="card-body">
                <h5 class="card-title">Blog Post Title</h5>
                <p class="card-text">Short excerpt from the blog post...</p>
                <a href="#" class="btn btn-primary">Read More</a>
            </div>
            </div>
        `,
        category: 'Blog'
        });



        document.getElementById('save-page').addEventListener('click', async function() {
            var content = editor.getHtml();  // Ottieni il contenuto HTML dall'editor di GrapesJS
            var slug = "{{ page.slug }}";     // Slug della pagina corrente
            var page_id = "{{ page.id }}";    // ID della pagina corrente
            var language = document.getElementById('language-selector').value; // Lingua selezionata

            if (!content) {
                Swal.fire('Error!', 'Content is empty.', 'error');
                return;
            }

                // Mostra un messaggio di caricamento
                Swal.fire({
                    title: 'Saving...',
                    text: 'Processing your content and uploading images.',
                    icon: 'info',
                    allowOutsideClick: false,
                    showConfirmButton: false,
                    didOpen: () => Swal.showLoading(),
                });

            // Funzione per gestire l'upload delle immagini in formato base64
            async function uploadBase64Image(base64Image) {
                try {
                    const response = await fetch('/upload-image', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ image: base64Image })
                    });
                    const data = await response.json();
                    if (data.url) {
                        return data.url; 
                    } else {
                        throw new Error('Image upload failed');
                    }
                } catch (error) {
                    console.error('Error uploading image:', error);
                    return null;
                }
            }

            // Processa tutte le immagini base64 trovate nel contenuto
            var div = document.createElement('div');
            div.innerHTML = content;
            var images = div.querySelectorAll('img');
            var uploadPromises = [];

            // Carica tutte le immagini in base64 e sostituisci i riferimenti nel contenuto
            for (let img of images) {
                if (img.src.startsWith('data:image')) {
                    const uploadPromise = uploadBase64Image(img.src).then(url => {
                        if (url) {
                            img.src = url;  
                        }
                    });
                    uploadPromises.push(uploadPromise);
                }
            }

            // Aspetta che tutte le immagini siano caricate e sostituite
            await Promise.all(uploadPromises);

            // Salva il contenuto nella tabella `pages`, identificando la lingua
            fetch("{{ url_for('page.save_page') }}", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    id: page_id,
                    content: div.innerHTML,   // Nuovo contenuto con immagini sostituite
                    language: language        // Lingua selezionata
                })
            }).then(response => response.json()).then(data => {
                if (data.success) {
                    Swal.fire('Saved!', 'Your page content has been successfully saved.', 'success');
                } else {
                    Swal.fire('Error!', 'There was an error saving the page content.', 'error');
                }
            }).catch(error => {
                console.error('Error:', error);
                Swal.fire('Error!', 'There was an error saving the page content.', 'error');
            });
        });
    });
</script>